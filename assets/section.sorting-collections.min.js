!function(t){"use strict";theme.SortingCollections=function(){function e(e){this.$container=t(e),this.namespace=".sorting-collections",this.onLoad()}return e.prototype=t.extend({},Section.prototype,e.prototype,{onLoad:function(){function e(e,n){c&&c.abort(),n&&theme.Loader.set(i);var r=e.attr("data-collection"),s=i.attr("data-limit"),l=i.attr("data-grid");c=t.ajax({type:"GET",url:"/collections/"+r,cache:!1,data:{view:"sorting",count_limit:s,grid_classes:encodeURIComponent(l)},dataType:"html",success:function(t){var r;if(i.html(t),i[0].hasAttribute("data-is-design-mode")&&(r=i.children(),r.addClass(l),r.length>s))for(var d=s;d<r.length;d++)r.eq(d).remove();theme.ImagesLazyLoad.update(),theme.ProductCurrency.update(),theme.ProductCountdown.init(i.find(".js-countdown")),theme.ProductReview.update(),o.find("a").removeClass("active"),e.addClass("active"),a&&a.text(theme.strings.homepage.sorting_collections.button_more_products.replace("{{ collection }}",e.text())).attr("href",e.attr("href")),n&&theme.Loader.unset(i),c=null}})}var o=this.$container.find("[data-sorting-collections-control]"),n=this.$container.find("[data-sorting-collections-ajax] [data-collection]"),i=this.$container.find("[data-sorting-collections-items]"),a=this.$container.find("[data-sorting-collections-more]"),c=null;this.$control=o,n.length&&e(n.first()),o.on("click","a",function(o){var n=t(this);return n.hasClass("active")||e(n,!0),o.preventDefault(),!1})},onUnload:function(){this.$container.off(this.namespace),this.$control.off()}}),e}(),t(function(){theme.sections.register("sorting-collections",theme.SortingCollections)})}(jQueryTheme);